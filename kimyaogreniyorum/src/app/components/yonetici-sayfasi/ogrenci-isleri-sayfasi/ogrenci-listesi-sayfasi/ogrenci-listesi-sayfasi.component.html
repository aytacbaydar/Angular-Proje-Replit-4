<div class="container-fluid p-4">
    <h2 class="mb-4">Öğrenci ve Öğretmen Yönetimi</h2>

    <!-- İstatistik Kartları -->
    <div class="row mb-4">
        <div class="col-md-4 col-sm-6 mb-3">
            <div class="stat-card bg-primary text-white">
                <div class="stat-card-body">
                    <div class="stat-card-icon">
                        <i class="bi bi-people"></i>
                    </div>
                    <div class="stat-card-info">
                        <h4 class="stat-card-number">{{ students.length }}</h4>
                        <p class="stat-card-title">Aktif Öğrenci</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4 col-sm-6 mb-3">
            <div class="stat-card bg-success text-white">
                <div class="stat-card-body">
                    <div class="stat-card-icon">
                        <i class="bi bi-person-video3"></i>
                    </div>
                    <div class="stat-card-info">
                        <h4 class="stat-card-number">{{ teachers.length }}</h4>
                        <p class="stat-card-title">Aktif Öğretmen</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4 col-sm-6 mb-3">
            <div class="stat-card bg-warning text-dark">
                <div class="stat-card-body">
                    <div class="stat-card-icon">
                        <i class="bi bi-person-plus"></i>
                    </div>
                    <div class="stat-card-info">
                        <h4 class="stat-card-number">{{ newUsers.length }}</h4>
                        <p class="stat-card-title">Onay Bekleyen</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="content-tabs">
        <ul class="nav nav-tabs" id="userTabs" role="tablist">
            <li class="nav-item" role="presentation">
                <button class="nav-link" [class.active]="activeTab === 'students'" id="students-tab" 
                        (click)="setActiveTab('students')" type="button">
                    <i class="bi bi-people me-1"></i> Öğrenciler
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" [class.active]="activeTab === 'teachers'" id="teachers-tab" 
                        (click)="setActiveTab('teachers')" type="button">
                    <i class="bi bi-person-video3 me-1"></i> Öğretmenler
                </button>
            </li>
            <li class="nav-item" role="presentation">
                <button class="nav-link" [class.active]="activeTab === 'new'" id="new-tab" 
                        (click)="setActiveTab('new')" type="button">
                    <i class="bi bi-person-plus me-1"></i> Yeni Kayıtlar
                    <span class="badge bg-warning text-dark ms-1" *ngIf="newUsers.length > 0">{{ newUsers.length }}</span>
                </button>
            </li>
        </ul>

        <div class="tab-content mt-3" id="userTabsContent">
            <!-- Öğrenciler Tablosu -->
            <div class="tab-pane fade" [class.show]="activeTab === 'students'" [class.active]="activeTab === 'students'">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Avatar</th>
                                <th scope="col">Ad Soyad</th>
                                <th scope="col">Email</th>
                                <th scope="col">Telefon</th>
                                <th scope="col">Okul</th>
                                <th scope="col">Sınıf</th>
                                <th scope="col">Grup</th>
                                <th scope="col">İşlemler</th>
                            </tr>
                        </thead>
                        <tbody *ngIf="!isLoading">
                            <tr *ngFor="let student of students; let i = index">
                                <th scope="row">{{ i + 1 }}</th>
                                <td>
                                    <img [src]="student.avatar || './assets/images/default-avatar.png'" 
                                         alt="Avatar" class="user-avatar">
                                </td>
                                <td>{{ student.adi_soyadi }}</td>
                                <td>{{ student.email }}</td>
                                <td>{{ student.cep_telefonu || '-' }}</td>
                                <td>{{ student.okulu || '-' }}</td>
                                <td>{{ student.sinifi || '-' }}</td>
                                <td>{{ student.grubu || '-' }}</td>
                                <td>
                                    <div class="btn-group">
                                        <a [routerLink]="['/yonetici-sayfasi/ogrenci-detay-sayfasi', student.id]" 
                                           class="btn btn-sm btn-outline-primary" title="Düzenle">
                                            <i class="bi bi-pencil"></i>
                                        </a>
                                        <button (click)="deleteStudent(student.id)" 
                                                class="btn btn-sm btn-outline-danger" title="Sil">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr *ngIf="students.length === 0">
                                <td colspan="9" class="text-center">Henüz öğrenci bulunamadı.</td>
                            </tr>
                        </tbody>
                        <tbody *ngIf="isLoading">
                            <tr>
                                <td colspan="9" class="text-center py-4">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Yükleniyor...</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Öğretmenler Tablosu -->
            <div class="tab-pane fade" [class.show]="activeTab === 'teachers'" [class.active]="activeTab === 'teachers'">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Avatar</th>
                                <th scope="col">Ad Soyad</th>
                                <th scope="col">Email</th>
                                <th scope="col">Telefon</th>
                                <th scope="col">Branş</th>
                                <th scope="col">İşlemler</th>
                            </tr>
                        </thead>
                        <tbody *ngIf="!isLoading">
                            <tr *ngFor="let teacher of teachers; let i = index">
                                <th scope="row">{{ i + 1 }}</th>
                                <td>
                                    <img [src]="teacher.avatar || './assets/images/default-avatar.png'" 
                                         alt="Avatar" class="user-avatar">
                                </td>
                                <td>{{ teacher.adi_soyadi }}</td>
                                <td>{{ teacher.email }}</td>
                                <td>{{ teacher.cep_telefonu || '-' }}</td>
                                <td>{{ teacher.brans || '-' }}</td>
                                <td>
                                    <div class="btn-group">
                                        <a [routerLink]="['/yonetici-sayfasi/ogretmen-detay-sayfasi', teacher.id]" 
                                           class="btn btn-sm btn-outline-primary" title="Düzenle">
                                            <i class="bi bi-pencil"></i>
                                        </a>
                                        <button (click)="deleteTeacher(teacher.id)" 
                                                class="btn btn-sm btn-outline-danger" title="Sil">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr *ngIf="teachers.length === 0">
                                <td colspan="7" class="text-center">Henüz öğretmen bulunamadı.</td>
                            </tr>
                        </tbody>
                        <tbody *ngIf="isLoading">
                            <tr>
                                <td colspan="7" class="text-center py-4">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Yükleniyor...</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Yeni Kayıtlar Tablosu -->
            <div class="tab-pane fade" [class.show]="activeTab === 'new'" [class.active]="activeTab === 'new'">
                <div class="table-responsive">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr>
                                <th scope="col">#</th>
                                <th scope="col">Ad Soyad</th>
                                <th scope="col">Email</th>
                                <th scope="col">Telefon</th>
                                <th scope="col">Rütbe</th>
                                <th scope="col">Kayıt Tarihi</th>
                                <th scope="col">İşlemler</th>
                            </tr>
                        </thead>
                        <tbody *ngIf="!isLoading">
                            <tr *ngFor="let user of newUsers; let i = index">
                                <th scope="row">{{ i + 1 }}</th>
                                <td>{{ user.adi_soyadi }}</td>
                                <td>{{ user.email }}</td>
                                <td>{{ user.cep_telefonu || '-' }}</td>
                                <td>{{ user.rutbe === 'ogrenci' ? 'Öğrenci' : 'Öğretmen' }}</td>
                                <td>{{ user.created_at | date:'dd/MM/yyyy HH:mm' }}</td>
                                <td>
                                    <div class="btn-group">
                                        <button class="btn btn-sm btn-outline-success" title="Onayla">
                                            <i class="bi bi-check-lg"></i>
                                        </button>
                                        <button class="btn btn-sm btn-outline-danger" title="Reddet">
                                            <i class="bi bi-x-lg"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr *ngIf="newUsers.length === 0">
                                <td colspan="7" class="text-center">Onay bekleyen kullanıcı bulunmamaktadır.</td>
                            </tr>
                        </tbody>
                        <tbody *ngIf="isLoading">
                            <tr>
                                <td colspan="7" class="text-center py-4">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Yükleniyor...</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>