
<div class="container-fluid px-4">
    <!-- İstatistik Kartları -->
    <div class="stats-row">
        <div class="row g-4 mb-4">
            <div class="col-12 col-sm-6 col-md-4">
                <div class="stats-card students-card">
                    <div class="stats-info">
                        <h3>{{ stats.totalStudents }}</h3>
                        <p>Toplam Öğrenci</p>
                    </div>
                    <div class="stats-icon">
                        <i class="bi bi-mortarboard-fill"></i>
                    </div>
                </div>
            </div>
            <div class="col-12 col-sm-6 col-md-4">
                <div class="stats-card teachers-card">
                    <div class="stats-info">
                        <h3>{{ stats.totalTeachers }}</h3>
                        <p>Toplam Öğretmen</p>
                    </div>
                    <div class="stats-icon">
                        <i class="bi bi-person-workspace"></i>
                    </div>
                </div>
            </div>
            <div class="col-12 col-sm-6 col-md-4">
                <div class="stats-card new-users-card">
                    <div class="stats-info">
                        <h3>{{ stats.newUsersToday }}</h3>
                        <p>Yeni Kayıt</p>
                    </div>
                    <div class="stats-icon">
                        <i class="bi bi-person-plus-fill"></i>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Kullanıcı Listeleri -->
    <div class="card border-0 shadow-sm">
        <div class="card-header bg-transparent py-3">
            <ul class="nav nav-tabs card-header-tabs">
                <li class="nav-item">
                    <a class="nav-link" [class.active]="activeTab === 'students'" (click)="setActiveTab('students')" href="javascript:void(0)">
                        <i class="bi bi-mortarboard me-1"></i> Öğrenciler
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" [class.active]="activeTab === 'teachers'" (click)="setActiveTab('teachers')" href="javascript:void(0)">
                        <i class="bi bi-person-workspace me-1"></i> Öğretmenler
                    </a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" [class.active]="activeTab === 'new'" (click)="setActiveTab('new')" href="javascript:void(0)">
                        <i class="bi bi-person-plus me-1"></i> Yeni Kayıtlar
                    </a>
                </li>
            </ul>
        </div>
        <div class="card-body">
            <!-- Öğrenci Tablosu -->
            <div *ngIf="activeTab === 'students'">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h5 class="card-title mb-0">Öğrenci Listesi</h5>
                    <div class="actions">
                        <button class="btn btn-sm btn-outline-primary" [routerLink]="['/yonetici-sayfasi/ogrenci-ekle-sayfasi']">
                            <i class="bi bi-plus-circle me-1"></i> Yeni Öğrenci Ekle
                        </button>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover table-striped align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>ID</th>
                                <th>Avatar</th>
                                <th>Ad Soyad</th>
                                <th>Email</th>
                                <th>Telefon</th>
                                <th>Okul</th>
                                <th>Sınıf</th>
                                <th>İşlemler</th>
                            </tr>
                        </thead>
                        <tbody *ngIf="!isLoading">
                            <tr *ngFor="let student of students">
                                <td>{{ student.id }}</td>
                                <td>
                                    <img [src]="student.avatar || 'https://ui-avatars.com/api/?name=' + student.adi_soyadi + '&background=random'" 
                                        class="avatar" alt="Avatar">
                                </td>
                                <td>{{ student.adi_soyadi }}</td>
                                <td>{{ student.email }}</td>
                                <td>{{ student.cep_telefonu || 'Belirtilmemiş' }}</td>
                                <td>{{ student.okulu || 'Belirtilmemiş' }}</td>
                                <td>{{ student.sinifi || 'Belirtilmemiş' }}</td>
                                <td>
                                    <div class="btn-group">
                                        <a [routerLink]="['/yonetici-sayfasi/ogrenci-detay-sayfasi', student.id]" 
                                        class="btn btn-sm btn-outline-primary" title="Düzenle">
                                            <i class="bi bi-pencil"></i>
                                        </a>
                                        <button (click)="deleteStudent(student.id)" 
                                                class="btn btn-sm btn-outline-danger" title="Sil">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr *ngIf="students.length === 0">
                                <td colspan="8" class="text-center py-4">
                                    <div class="empty-state">
                                        <i class="bi bi-search"></i>
                                        <p>Henüz öğrenci bulunamadı.</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                        <tbody *ngIf="isLoading">
                            <tr>
                                <td colspan="8" class="text-center py-4">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Yükleniyor...</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Öğretmen Tablosu -->
            <div *ngIf="activeTab === 'teachers'">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h5 class="card-title mb-0">Öğretmen Listesi</h5>
                    <div class="actions">
                        <button class="btn btn-sm btn-outline-primary" [routerLink]="['/yonetici-sayfasi/ogretmen-ekle-sayfasi']">
                            <i class="bi bi-plus-circle me-1"></i> Yeni Öğretmen Ekle
                        </button>
                    </div>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover table-striped align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>ID</th>
                                <th>Avatar</th>
                                <th>Ad Soyad</th>
                                <th>Email</th>
                                <th>Telefon</th>
                                <th>Branş</th>
                                <th>İşlemler</th>
                            </tr>
                        </thead>
                        <tbody *ngIf="!isLoading">
                            <tr *ngFor="let teacher of teachers">
                                <td>{{ teacher.id }}</td>
                                <td>
                                    <img [src]="teacher.avatar || 'https://ui-avatars.com/api/?name=' + teacher.adi_soyadi + '&background=random'" 
                                        class="avatar" alt="Avatar">
                                </td>
                                <td>{{ teacher.adi_soyadi }}</td>
                                <td>{{ teacher.email }}</td>
                                <td>{{ teacher.cep_telefonu || 'Belirtilmemiş' }}</td>
                                <td>{{ teacher.brans || 'Belirtilmemiş' }}</td>
                                <td>
                                    <div class="btn-group">
                                        <a [routerLink]="['/yonetici-sayfasi/ogretmen-detay-sayfasi', teacher.id]" 
                                        class="btn btn-sm btn-outline-primary" title="Düzenle">
                                            <i class="bi bi-pencil"></i>
                                        </a>
                                        <button (click)="deleteTeacher(teacher.id)" 
                                                class="btn btn-sm btn-outline-danger" title="Sil">
                                            <i class="bi bi-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr *ngIf="teachers.length === 0">
                                <td colspan="7" class="text-center py-4">
                                    <div class="empty-state">
                                        <i class="bi bi-search"></i>
                                        <p>Henüz öğretmen bulunamadı.</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                        <tbody *ngIf="isLoading">
                            <tr>
                                <td colspan="7" class="text-center py-4">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Yükleniyor...</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Yeni Kayıtlar Tablosu -->
            <div *ngIf="activeTab === 'new'">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <h5 class="card-title mb-0">Son 24 Saatte Kayıt Olan Kullanıcılar</h5>
                </div>
                <div class="table-responsive">
                    <table class="table table-hover table-striped align-middle">
                        <thead class="table-light">
                            <tr>
                                <th>ID</th>
                                <th>Avatar</th>
                                <th>Ad Soyad</th>
                                <th>Email</th>
                                <th>Rol</th>
                                <th>Kayıt Tarihi</th>
                                <th>İşlemler</th>
                            </tr>
                        </thead>
                        <tbody *ngIf="!isLoading">
                            <tr *ngFor="let user of newUsers">
                                <td>{{ user.id }}</td>
                                <td>
                                    <img [src]="user.avatar || 'https://ui-avatars.com/api/?name=' + user.adi_soyadi + '&background=random'" 
                                        class="avatar" alt="Avatar">
                                </td>
                                <td>{{ user.adi_soyadi }}</td>
                                <td>{{ user.email }}</td>
                                <td>
                                    <span [ngClass]="{
                                        'badge bg-success': user.rutbe === 'ogrenci',
                                        'badge bg-primary': user.rutbe === 'ogretmen',
                                        'badge bg-danger': user.rutbe === 'admin'
                                    }">
                                        {{ user.rutbe === 'ogrenci' ? 'Öğrenci' : user.rutbe === 'ogretmen' ? 'Öğretmen' : 'Yönetici' }}
                                    </span>
                                </td>
                                <td>{{ user.created_at | date:'dd/MM/yyyy HH:mm' }}</td>
                                <td>
                                    <div class="btn-group">
                                        <a [routerLink]="['/yonetici-sayfasi/' + (user.rutbe === 'ogrenci' ? 'ogrenci' : 'ogretmen') + '-detay-sayfasi', user.id]" 
                                        class="btn btn-sm btn-outline-primary" title="Düzenle">
                                            <i class="bi bi-pencil"></i>
                                        </a>
                                    </div>
                                </td>
                            </tr>
                            <tr *ngIf="newUsers.length === 0">
                                <td colspan="7" class="text-center py-4">
                                    <div class="empty-state">
                                        <i class="bi bi-calendar-check"></i>
                                        <p>Son 24 saatte yeni kayıt bulunmamaktadır.</p>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                        <tbody *ngIf="isLoading">
                            <tr>
                                <td colspan="7" class="text-center py-4">
                                    <div class="spinner-border text-primary" role="status">
                                        <span class="visually-hidden">Yükleniyor...</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
